<html>
  <head>
    <title>Immeubles appartenant à la ville de Rimouski</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      var map;
      var geocoder;
      var address ="66 avenue Voyer, Rimouski, Québec, Canada";
      var addresses=[
        {% for immeuble in site.data.Immeubles_Ville_Rimouski%}
        "{{immeuble.adresse}} ,Rimouski, Québec, Canada",
        {%endfor%}
      ];
      //alert(addresses);
      function addAdress(_address){

        if (geocoder) {
      geocoder.geocode( { 'address': _address}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          if (status != google.maps.GeocoderStatus.ZERO_RESULTS) {
          map.setCenter(results[0].geometry.location);

            var infowindow = new google.maps.InfoWindow(
                { content: '<b>'+_address+'</b>',
                  size: new google.maps.Size(150,50)
                });

            var marker = new google.maps.Marker({
                position: results[0].geometry.location,
                map: map,
                title:_address
            });
            google.maps.event.addListener(marker, 'click', function() {
                infowindow.open(map,marker);
            });

          } else {
            alert("No results found");
          }
        } else {
          alert("Geocode was not successful for the following reason: " + status);
        }
      });
      };
      }



      function initMap() {
        geocoder = new google.maps.Geocoder();
        var latlng = new google.maps.LatLng({{site.data.geo.Latitude}}, {{site.data.geo.Longitude}});
        var myOptions = {
             zoom: 13,
             center: latlng,
           mapTypeControl: true,
           mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},
           navigationControl: true,
             mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById('map'), myOptions);
        var nbAddresses=addresses.length;
        //alert(nbAddresses);
        for (var i=0; i<nbAddresses;i++){
        //  alert(addresses[i]);
           addAdress();
      }


      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8reK-vQo8qn9zvJWQe6OVJ1ABNkSGQ6o &callback=initMap"
    async defer></script>
  </body>
</html>
